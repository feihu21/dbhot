"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(){function e(t){if((t="object"!==_typeof(t)?{}:t).code){for(var e in this._commonParams={chl:t.chl||"",r:encodeURIComponent(document.referrer||window.location.href),fBL:window.screen.width+"*"+window.screen.height},this._code=t.code,this._commonKeyValues=["uId2="+(t.uId2||"SPTNPQRLSX")],this._commonParams)this._commonKeyValues.push(e+"="+this._commonParams[e]);this._stopProgapation=!1,t.defaultListener instanceof Array?this.defaultListener=t.defaultListener:this.defaultListener=["visit","click"],this.vueRouter=null,t.vueRouter instanceof Object&&(this.vueRouter=t.vueRouter),this.listenerStatus=0,this._createHandle(),this._startListener()}else console.error("code为埋点sdk的必要参数")}Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");function e(){}function n(){return i.apply(this instanceof e&&t?this:t,o.concat(Array.prototype.slice.call(arguments)))}var o=Array.prototype.slice.call(arguments,1),i=this;return e.prototype=this.prototype,n.prototype=new e,n}),e.prototype._createHandle=function(){this._visitHandle=function(){var t={client_time:this.formatByDate(new Date)};this.reportMethod({act:"visit",ext:encodeURIComponent(this.stringify(t))})}.bind(this),this._clickHandle=function(t){this._stopProgapation||(t=this.getTarget(t),(t=this.getDataset(t)||{}).client_time=this.formatByDate(new Date),this.reportMethod({act:"click",ext:encodeURIComponent(this.stringify(t))}))}.bind(this)},e.prototype._startListener=function(){this.defaultListener.length&&(this.listenerStatus=1);for(var t=0;t<this.defaultListener.length;t++)switch(this.defaultListener[t]){case"visit":this.vueRouter?this._handleVueRouterChange():(this.addHandler(window,"load",this._visitHandle),this.addHandler(window,"hashchange",this._visitHandle),this.addHandler(window,"popstate",this._visitHandle));break;case"click":this.addHandler(document,"click",this._clickHandle)}},e.prototype._handleVueRouterChange=function(){var t;1===this.listenerStatus&&(t=this).vueRouter.afterEach(function(){t._visitHandle()})},e.prototype.closeListener=function(){for(var t=0;t<this.defaultListener.length;t++)switch(this.defaultListener[t]){case"visit":this.vueRouter||(this.removeHandler(window,"load",this._visitHandle),this.removeHandler(window,"hashchange",this._visitHandle),this.removeHandler(window,"popstate",this._visitHandle));break;case"click":this.removeHandler(document,"click",this._clickHandle)}this.listenerStatus=0},e.prototype.restartListener=function(){0===this.listenerStatus&&this._startListener()},e.prototype.report=function(t){"object"!==_typeof(t)&&(t={}),this._stopProgapation=!0;var e=this;setTimeout(function(){e._stopProgapation=!1},0),t.act?void 0===t.ext||null===t.ext||"object"===_typeof(t.ext)?(t.ext=t.ext||{},t.ext.client_time=this.formatByDate(new Date),t={act:t.act||"",ext:t.ext?encodeURIComponent(this.stringify(t.ext)):""},this.reportMethod(t)):console.error("ext必须为json类型"):console.error("act是上报的必要参数")},e.prototype.reportMethod=function(t){var e,n=["lO="+encodeURIComponent(window.location.href)];for(e in t)n.push(e+"="+t[e]);var o="//web.50bangzh.com/web/"+this._code+"?"+this._commonKeyValues.concat(n).join("&"),i=new Image;i.onload=i.onerror=i.onabort=function(){i.onload=i.onerror=i.onabort=null,i=null},i.referrerpolicy="no-referrer-when-downgrade",i.src=o},e.prototype.addHandler=function(t,e,n){t.addEventListener?t.addEventListener(e,n):t.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n},e.prototype.removeHandler=function(t,e,n){t.removeEventListener?t.removeEventListener(e,n):t.detachEvent?t.detachEvent("on"+e,n):t["on"+e]=null},e.prototype.getEvent=function(t){return t||window.event},e.prototype.getTarget=function(t){return(t=this.getEvent(t)).target||t.srcElement},e.prototype.getDataset=function(t){if(t.dataset)return t.dataset;for(var e=t.attributes,n={},o=0;o<e.length;o++){var i=e[o].name.match(/^data-(.+)/);i&&(n[i[1].replace(/-[\da-z]/gi,function(t){return t.substring(1,2).toUpperCase()+t.substring(2)})]=e[o].value)}return n},e.prototype.stringify=function(t){if("object"===("undefined"==typeof JSON?"undefined":_typeof(JSON)))return JSON.stringify(t);var e,n=[];for(e in t){var o=t[e];"string"==typeof(o=null==o?String(t[e]):o)?o='"'+o+'"':"object"===_typeof(o)&&(o=this.stringify(t[e])),n.push('"'+e+'":'+o)}return"{"+n.join(",")+"}"},e.prototype.formatByDate=function(t,e){var n,o=e||"yyyy-MM-dd hh:mm:ss",i={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};for(n in/(y+)/.test(o)&&(o=o.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),i)new RegExp("("+n+")").test(o)&&(o=o.replace(RegExp.$1,1==RegExp.$1.length?i[n]:("00"+i[n]).substr((""+i[n]).length)));return o},e.prototype.padLeftZero=function(t){return("00"+t).substr(t.length)},e.attach=function(t){return new e(t)},"function"==typeof define&&"object"===_typeof(define.amd)&&define.amd?define(function(){return e}):"undefined"!=typeof module&&module.exports?(module.exports=e.attach,module.exports.StatisticsReport=e):window.StatisticsReport=e}();
